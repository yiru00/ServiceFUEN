import{_ as X,l as q,x as l,G as E,z as J,r as T,o as d,c as i,b as o,t as D,J as n,q as w,d as r,w as m,n as K,e as P,g as Y,f as V,F,a as H,h,K as O,p as Q,j as W}from"./index-9fdc7868.js";import{_ as Z}from"./userPic-2a6011f5.js";const p=y=>(Q("data-v-be22a5fd"),y=y(),W(),y),oo={class:"bag"},eo={class:"about"},to=p(()=>o("h4",{class:"text-light"},"關於",-1)),so={class:"text-light"},lo={class:"container-fluid"},ao={class:"d-flex justify-content-center"},no={class:"p-4 content"},co={class:"col-xl-3 col-lg-12 user"},io={class:"userInfo"},uo={class:"userText"},ro={class:"userProfile"},mo=["src","alt"],ho={key:1,class:"imgPhoto mb-3 mb-sm-3 me-md-3 me-xl-0 mb-lg-2",src:Z,alt:"1"},_o={class:"fs-5 m-0"},po={class:"userBtn"},vo={key:0,class:"uploadPhotoBtn","data-bs-toggle":"modal","data-bs-target":"#uploadPhotoModal"},bo={class:"col-xl-9 gy-4 col-lg-12 photoGrid"},go={class:"row gy-4"},fo={class:"col-12 userLinkGroup"},Po={key:1,class:"dropdown"},yo={role:"button",class:"userLink dropdown-toggle toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},xo={class:"dropdown-menu staticBtnGroup"},ko={class:"modal fade",tabindex:"-1",id:"uploadPhotoModal"},Co={class:"modal-dialog"},wo={class:"modal-content"},Ao=p(()=>o("div",{class:"modal-header border-bottom-0"},[o("h5",{class:"modal-title"},"上傳相片"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),$o={class:"modal-body"},Io={class:"previewPhoto"},Bo=["src"],Vo={class:"form-floating mb-3"},So=p(()=>o("label",{for:"floatingTitle"},"標題",-1)),Ro={class:"form-floating mb-3"},To=p(()=>o("label",{for:"floatingCamera"},"相機",-1)),Do={class:"modal fade",tabindex:"-1",id:"uploadAlbumModal"},Fo={class:"modal-dialog modal-lg"},Lo={class:"modal-content"},Mo=p(()=>o("div",{class:"modal-header border-bottom-0"},[o("h5",{class:"modal-title"},"上傳相簿"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),Go={class:"modal-body"},Uo={class:"form-floating mb-3"},zo=p(()=>o("label",{for:"floatingAlbumTitle"},"相簿標題",-1)),No={class:"row gy-3 gx-3"},jo={class:"card border-0"},Xo=["src","alt"],qo=["value"],Eo={__name:"PersonalPage",setup(y){const L=q(),S=l([]),u=l([]),x=l(!1),R=l("uploadFile"),A=l(!1),I=l(""),B=l(!1),k=l({}),v=l(""),b=l(""),s=E(()=>L.params.memberId),g=l([]),f=l(""),C=l($.cookie("token")),_=l("");axios.get("https://localhost:7259/api/Members/Read",{headers:{Authorization:`Bearer ${C.value}`}}).then(e=>{_.value=e.data,console.log("登入ID"),console.log(_.value)}).catch(e=>{console.log("MY未登入")});const M=e=>{const t=e.target.files[0];k.value=t;const a=new FileReader;a.readAsDataURL(t),a.onload=()=>{B.value=!0,console.log(a.result),I.value=a.result}},G=async function(){console.log(k.value),console.log(v.value),console.log(b.value);const e=new FormData;e.append("Id",0),e.append("File",k.value),e.append("Title",v.value),e.append("Camera",b.value),await axios.post("https://localhost:7259/api/Photo/Create",e,{headers:{Authorization:`Bearer ${C.value}`}}).then(t=>{console.log("上傳照片成功"),x.value=!0,k.value=null,v.value="",b.value="",I.value="",B.value=!1,R.value.value=""}).catch(t=>{console.log(t)}),x.value=!1,console.log("上傳成功後value?"+x.value)},U=function(){console.log(g.value);const e=g.value.slice();console.log(e),console.log(f.value),axios.post("https://localhost:7259/api/Album/CreateAlbum",{albumName:f.value,photoId:e},{headers:{Authorization:`Bearer ${C.value}`}}).then(t=>{console.log("上傳相簿成功"),A.value=!0,f.value="",g.value=[]}).catch(t=>console.log(t)),A.value=!1};axios.get(`https://localhost:7259/api/Photo/GetProfile?memberId=${s.value}`).then(e=>{u.value=e.data}).catch(e=>console.log(e));const z=()=>{axios.get(`https://localhost:7259/api/Photo/AllPhotos?memberId=${s.value}`,{headers:{Authorization:`Bearer ${C.value}`}}).then(e=>{S.value=e.data}).catch(e=>console.log(e))};return J(s,()=>{axios.get(`https://localhost:7259/api/Photo/GetProfile?memberId=${s.value}`).then(e=>{u.value=e.data}).catch(e=>console.log(e))}),(e,t)=>{const a=T("RouterLink"),N=T("RouterView");return d(),i(F,null,[o("div",oo,[o("div",eo,[to,o("p",so,D(u.value.about),1)])]),o("div",lo,[o("div",ao,[o("div",no,[o("div",co,[o("div",io,[o("div",uo,[o("div",ro,[u.value.source!=null?(d(),i("img",{key:0,class:"imgPhoto mb-3 mb-sm-3 me-md-3 me-xl-0 mb-lg-2",src:`https://localhost:7259/Images/${u.value.source}`,alt:u.value.source},null,8,mo)):(d(),i("img",ho)),o("p",_o,D(u.value.name),1)]),o("div",po,[_.value==n(s)?(d(),i("button",vo," 新增相片 ")):w("",!0),_.value==n(s)?(d(),i("button",{key:1,class:"uploadAlbumBtn","data-bs-toggle":"modal","data-bs-target":"#uploadAlbumModal",onClick:z}," 新增相簿 ")):w("",!0)])])])]),o("div",bo,[o("div",go,[o("div",fo,[r(a,{to:`/Community/PersonalPage/${n(s)}/Photos`,class:"userLink"},{default:m(()=>[h("相片")]),_:1},8,["to"]),r(a,{to:`/Community/PersonalPage/${n(s)}/Albums`,class:"userLink"},{default:m(()=>[h("相簿")]),_:1},8,["to"]),_.value==n(s)?(d(),K(a,{key:0,to:`/Community/PersonalPage/${n(s)}/Collections`,class:"userLink"},{default:m(()=>[h("收藏")]),_:1},8,["to"])):w("",!0),_.value==n(s)?(d(),i("div",Po,[o("button",yo,[r(a,{to:`/Community/PersonalPage/${n(s)}/Statics/DateViews`,class:"link"},{default:m(()=>[h("統計")]),_:1},8,["to"])]),o("ul",xo,[o("li",null,[r(a,{to:`/Community/PersonalPage/${n(s)}/Statics/DateViews`},{default:m(()=>[h("7天總瀏覽")]),_:1},8,["to"])]),o("li",null,[r(a,{to:`/Community/PersonalPage/${n(s)}/Statics/CameraUse`},{default:m(()=>[h("相機使用率")]),_:1},8,["to"])]),o("li",null,[r(a,{to:`/Community/PersonalPage/${n(s)}/Statics/TopPhotoViews`},{default:m(()=>[h("最高瀏覽照片")]),_:1},8,["to"])])])])):w("",!0)]),r(N,{uploadProp:x.value,uploadAlbumProp:A.value},null,8,["uploadProp","uploadAlbumProp"])])])])])]),o("div",ko,[o("div",Co,[o("div",wo,[Ao,o("div",$o,[o("input",{class:"form-control fileContent",type:"file",onChange:M,id:"formFile",accept:"image/*",ref_key:"uploadFile",ref:R},null,544),o("div",Io,[P(o("img",{src:I.value,alt:"XXXX"},null,8,Bo),[[Y,B.value]])]),o("div",Vo,[P(o("input",{type:"text",class:"form-control",id:"floatingTitle","onUpdate:modelValue":t[0]||(t[0]=c=>v.value=c),placeholder:"標題"},null,512),[[V,v.value]]),So]),o("div",Ro,[P(o("input",{type:"text",class:"form-control",id:"floatingCamera","onUpdate:modelValue":t[1]||(t[1]=c=>b.value=c),placeholder:"相機"},null,512),[[V,b.value]]),To]),o("div",{class:"d-flex justify-content-end"},[o("button",{onClick:G,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 送出 ")])])])])]),o("div",Do,[o("div",Fo,[o("div",Lo,[Mo,o("div",Go,[o("div",Uo,[P(o("input",{type:"text",class:"form-control",id:"floatingAlbumTitle",placeholder:"標題","onUpdate:modelValue":t[2]||(t[2]=c=>f.value=c)},null,512),[[V,f.value]]),zo]),o("div",No,[(d(!0),i(F,null,H(S.value,c=>(d(),i("div",{class:"col-12 col-sm-6 col-md-4 col-lg-3",key:c.id},[o("div",jo,[o("img",{src:`https://localhost:7259/Images/${c.source}`,class:"card-img-top rounded-bottom",alt:c.source},null,8,Xo),P(o("input",{type:"checkbox",class:"albumCheckbox","onUpdate:modelValue":t[3]||(t[3]=j=>g.value=j),value:c.id},null,8,qo),[[O,g.value]])])]))),128))]),o("div",{class:"d-flex justify-content-end"},[o("button",{onClick:U,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 送出 ")])])])])])],64)}}},Yo=X(Eo,[["__scopeId","data-v-be22a5fd"]]);export{Yo as default};
