import{a as c}from"./axios-aba6f0e0.js";import{_ as f,u as _,r as b,o as d,c as h,b as t,t as p,e as n,v,F as g,a as w,f as u,g as A,d as k,w as y,p as C,j as x}from"./index-9fdc7868.js";const F={name:"CreateArticle",data(){return{photoData:"",photoshow:!1,photofile:{},objArticleforumall:[],profileInfo:{},title:"",message:"",objArticleforumallid:""}},mixins:[_],created(){this.loginPerson(),this.callCreateArticleForumAllApi()},methods:{openfile(){this.$refs.file.click()},showPhoto(o){const e=o.target.files[0];this.photofile=e;const a=new FileReader;a.readAsDataURL(e),a.onload=()=>{this.photoshow=!0,this.photoData=a.result}},async goSubmit(){console.log(this.photofile),console.log(this.title),console.log(this.description);const o=new FormData;o.append("Id",2),o.append("File",this.photofile),o.append("Title",this.title),o.append("Description",this.title),await c.post("https://localhost:7259/api/Photo/Create",o).then(e=>{console.log("GOGO")}).catch(e=>{console.log(e)})},async callCreateArticleApi(o){console.log(this.token),await c.post("https://localhost:7259/api/Article/CreateArticle",o,{headers:{Authorization:`Bearer ${this.token}`}}).then(()=>{console.log("成功"),this.$router.push("/Forum")}).catch(e=>{console.log(e)})},async callCreateArticleForumAllApi(){await c.get("https://localhost:7259/api/Forum/ForumAll").then(o=>{this.objArticleforumall=o.data}).catch(o=>{console.log(o)})},async createnow(){let o=await this.fetchMemberId();console.log(Number(this.objArticleforumallid));const e=new FormData;e.append("MemberId",o),e.append("Title",this.title),e.append("Files",this.photofile),e.append("Content",this.message),e.append("ForumId",Number(this.objArticleforumallid)),this.callCreateArticleApi(e)},async loginPerson(){let o=await this.fetchMemberId();o!=0&&fetch(`https://localhost:7259/api/Members/Profile?id=${o}`,{method:"GET",headers:{Authorization:`bearer ${$.cookie("token")}`}}).then(e=>e.json()).then(e=>{this.profileInfo=e}).catch(e=>{console.error(e)})}},computed:{token(){return $.cookie("token")}}},r=o=>(C("data-v-45317eb3"),o=o(),x(),o),j={class:"container article_banners"},D={class:"row justify-content-center"},I={class:"article_insert col-md-10"},P=r(()=>t("div",{class:"card-header d-flex justify-content-between article_title"},[t("a",{class:"nav-link active fs-3","aria-current":"true"}," 創建文章 ")],-1)),S={class:"post"},B={class:"d-flex"},M={class:"author"},N={class:"date ms-2"},V={class:"article_change"},T=r(()=>t("p",{class:"forumP"},"看板 : ",-1)),U=r(()=>t("option",{value:"",class:"",disabled:""},"未選擇",-1)),G=["value"],L={class:"d-flex flex-column align-items-center justify-content-center"},z={class:"insert mb-2"},E={class:"mt-2"},O={class:"ms-3"},R={class:"createimg"},q=["src"],H={class:"insert_check"},J=r(()=>t("button",{type:"button",class:"btn ms-2 cancelBtn"},"取消",-1));function K(o,e,a,Q,l,i){const m=b("router-link");return d(),h("div",j,[t("div",D,[t("div",I,[P,t("div",S,[t("div",B,[t("p",M,"作者："+p(l.profileInfo.nickName),1),t("p",N,"發布時間："+p(new Date().toLocaleString()),1)]),t("div",V,[T,n(t("select",{class:"ms-2 form-select","onUpdate:modelValue":e[0]||(e[0]=s=>l.objArticleforumallid=s)},[U,(d(!0),h(g,null,w(l.objArticleforumall,s=>(d(),h("option",{key:s.id,value:s.id,class:""},p(s.name),9,G))),128))],512),[[v,l.objArticleforumallid]])])]),t("div",L,[t("div",z,[n(t("textarea",{class:"form-control textareaColor","onUpdate:modelValue":e[1]||(e[1]=s=>l.title=s),name:"",id:"",cols:"102",rows:"0",placeholder:"標題..."},null,512),[[u,l.title]])]),t("div",null,[n(t("textarea",{class:"form-control textareaColor","onUpdate:modelValue":e[2]||(e[2]=s=>l.message=s),name:"",id:"",cols:"102",rows:"10",placeholder:"內文..."},null,512),[[u,l.message]])])]),t("div",E,[t("div",O,[t("button",{onClick:e[3]||(e[3]=(...s)=>i.openfile&&i.openfile(...s)),class:"btn btn_submit"},"新增照片"),t("input",{type:"file",onChange:e[4]||(e[4]=(...s)=>i.showPhoto&&i.showPhoto(...s)),ref:"file",style:{display:"none"},class:"form-control"},null,544),t("div",R,[n(t("img",{src:l.photoData,alt:"error"},null,8,q),[[A,l.photoshow]])])]),t("div",H,[t("div",null,[t("button",{type:"button",class:"btn bottomBtn",onClick:e[5]||(e[5]=(...s)=>i.createnow&&i.createnow(...s))},"新增")]),t("div",null,[k(m,{to:"/Forum"},{default:y(()=>[J]),_:1})])])])])])])}const Y=f(F,[["render",K],["__scopeId","data-v-45317eb3"]]);export{Y as default};
