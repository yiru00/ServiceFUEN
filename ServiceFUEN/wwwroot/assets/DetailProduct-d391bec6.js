import{a as d}from"./axios-aba6f0e0.js";import{_ as g,u as _,D as m,E as v,o as a,a as c,b as e,t as i,G as u,F as I,l as S,z as f,A as y}from"./index-3f0bd573.js";const b={mixins:[_],name:"DetailProduct",setup(){const s=m();return v(),{toSoppingCart:l=>{sessionStorage.setItem("productSelItem",JSON.stringify(l)),s.push("/ShoppingCart")}}},data(){return{detail:{},coverimg:"",picture:[],MId:0,PId:0,status:{},cartsSelect:[]}},created(){this.scrollToTop(),this.CallDetailProductsApi(),this.CallFavoritesStatus(),this.getStorageCart()},mounted(){this.GetMemberId()},methods:{async CallDetailProductsApi(){let s=this.$route.path.slice(9);this.PId=s,console.log(s),d.get(`https://localhost:7259/api/Product/DetailProducts?Id=${s}`).then(t=>{this.detail=t.data,this.picture=this.detail.source,this.coverimg=this.detail.source[0],this.picture=this.picture.slice(1),console.log(this.picture)}).catch(t=>{console.log(t)})},async GetMemberId(){this.MId=await this.fetchMemberId(),console.log(this.MId)},async CallProductFavorites(){await d.post(`https://localhost:7259/api/Favorites/ProductFavorites?memberId=${this.MId}&productId=${this.PId}`).then(s=>{console.log(s.data);let t=s.data;t.upshot&&(this.status.deleteId=t.deleteId,this.status.upshot=!0,this.showAlert(t.reply))}).catch(s=>{console.log(s)})},async CallUnFavorites(s){d.delete(`https://localhost:7259/api/favorites/unfavorites/${s}`).then(t=>{t&&(this.status.upshot=!1,this.status.deleteId=0,this.showAlert("取消收藏成功")),console.log(t)}).catch(t=>{console.log(t)})},async CallFavoritesStatus(){let s=await this.fetchMemberId();d.get(`https://localhost:7259/api/Favorites/FavoritesStatus?memberId=${s}&productId=${this.PId}`).then(t=>{this.status=t.data,console.log(this.status)}).catch(t=>{console.log(t)})},saveLocalStorage(s,t){localStorage.setItem(s,JSON.stringify(t))},getlocalStorage(s){this[s]=JSON.parse(localStorage.getItem(s))},getStorageCart(){this.getlocalStorage("cartsSelect"),this.cartsSelect||(this.cartsSelect=[])},buyDirectly(s){let t=this.cartsSelect.find(l=>l.Id==s.id);if(t){let l=this.cartsSelect.indexOf(t);this.cartsSelect[l].Qty++}else this.cartsSelect.push({Id:s.id,Qty:1,Name:s.name,Price:s.price});this.saveLocalStorage("cartsSelect",this.cartsSelect)}}},h=s=>(f("data-v-5b763d60"),s=s(),y(),s),P={class:"container h-100 py-5"},C={class:"topProduct"},F={class:"ProName"},M={class:"ProName-P"},k={class:"Pro-lef d-flex"},x=["src"],D=h(()=>e("div",{class:"Pro-right"},"加寬",-1)),w={class:"Id-Pborder"},N={class:"add-btn"},A={key:0,class:"fa-regular fa-star","data-bs-toggle":"modal","data-bs-target":"#loginModal"},B=h(()=>e("div",{class:"TBborder"},[e("p",{class:"PBack"},"商品介紹")],-1)),O={class:"botproduct"},T=["src"],G={class:"spec-Out"},J=h(()=>e("p",null,"Fujifilm Instax Mini 90 銀色",-1)),L={class:"Spec"};function j(s,t,l,E,o,n){return a(),c("div",P,[e("div",C,[e("div",F,[e("p",M,i(o.detail.name),1)]),e("div",null,[e("div",k,[e("img",{class:"card-img",src:"https://localhost:7027/ProductImgFiles/"+o.coverimg,style:{width:"470px","object-fit":"cover"},alt:""},null,8,x),D,e("div",null,[e("p",w,"商品編號 : "+i(o.detail.id),1),e("p",null,"商品類別 : "+i(o.detail.categoryName),1),e("p",null,"品牌 : "+i(o.detail.brandName),1),e("p",null,"庫存量 : "+i(o.detail.inventory),1),e("span",null," NT "+i(o.detail.price),1),e("button",{class:"add-btn",onClick:t[0]||(t[0]=u(r=>this.toSoppingCart(o.detail),["stop"]))}," 直接購買 "),e("div",null,[e("button",{class:"add-btn",onClick:t[1]||(t[1]=u(r=>n.buyDirectly(o.detail),["stop"]))}," 購物車 "),e("button",N,[o.MId==0?(a(),c("i",A)):o.status.upshot?(a(),c("i",{key:2,onClick:t[3]||(t[3]=r=>n.CallUnFavorites(o.status.deleteId)),class:"fa-solid fa-star"})):(a(),c("i",{key:1,onClick:t[2]||(t[2]=r=>n.CallProductFavorites()),class:"fa-regular fa-star"}))])])])])])]),B,e("div",O,[(a(!0),c(I,null,S(o.picture,(r,p)=>(a(),c("div",{key:p},[e("img",{class:"card-img",src:"https://localhost:7027/ProductImgFiles/"+r,style:{width:"100%"},alt:""},null,8,T)]))),128)),e("div",G,[J,e("p",L," 商品介紹: "+i(o.detail.productSpec),1)])])])}const U=g(b,[["render",j],["__scopeId","data-v-5b763d60"]]);export{U as default};
